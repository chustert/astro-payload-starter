---
/**
 * Card2 Component (Molecule)
 *
 * A card with an image at the top, followed by content below.
 * Ideal for blog posts, products, or feature showcases.
 *
 * Naming: Card2 follows Relume naming convention.
 * - Card1: Basic card with slots
 * - Card2: Card with image top (this component)
 * - Card3: Horizontal card layout
 *
 * @example
 * <Card2
 *   imageSrc="/images/feature.jpg"
 *   imageAlt="Feature image"
 *   title="Feature Title"
 *   description="Feature description text."
 * />
 *
 * @customization
 * Override these CSS variables to customize:
 * --card2-bg, --card2-padding, --card2-border-radius
 * --card2-shadow, --card2-image-height
 */

interface Props {
  /** Image source URL */
  imageSrc?: string;
  /** Image alt text */
  imageAlt?: string;
  /** Card title */
  title?: string;
  /** Card description */
  description?: string;
  /** Card style variant */
  variant?: 'elevated' | 'outlined' | 'filled';
  /** Aspect ratio for image */
  imageAspect?: '16/9' | '4/3' | '1/1' | '3/2';
  /** Make card interactive (clickable) */
  interactive?: boolean;
  /** Link href (makes entire card clickable) */
  href?: string;
  /** Additional CSS classes */
  class?: string;
  [key: string]: any;
}

const {
  imageSrc,
  imageAlt = '',
  title,
  description,
  variant = 'elevated',
  imageAspect = '16/9',
  interactive = false,
  href,
  class: className = '',
  ...rest
} = Astro.props;

const isLink = !!href;
const Element = isLink ? 'a' : 'article';

const classes = [
  'card2',
  `card2--${variant}`,
  (interactive || isLink) && 'card2--interactive',
  className,
].filter(Boolean).join(' ');

const hasActions = Astro.slots.has('actions');
const hasContent = Astro.slots.has('default');
---

<Element class={classes} href={isLink ? href : undefined} {...rest}>
  {imageSrc && (
    <div class="card2_image-wrapper" style={`--card2-image-aspect: ${imageAspect}`}>
      <img src={imageSrc} alt={imageAlt} class="card2_image" />
    </div>
  )}

  <div class="card2_content">
    {title && (
      <h3 class="card2_title">{title}</h3>
    )}
    {description && (
      <p class="card2_description">{description}</p>
    )}
    {hasContent && (
      <div class="card2_body">
        <slot />
      </div>
    )}
    {hasActions && (
      <div class="card2_actions">
        <slot name="actions" />
      </div>
    )}
  </div>
</Element>

<style>
  .card2 {
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border-radius: var(--card2-border-radius, var(--radius-lg));
  }

  /* ============================================
     Variant Styles
     ============================================ */

  .card2--elevated {
    background-color: var(--card2-elevated-bg, var(--color-bg-primary));
    box-shadow: var(--card2-elevated-shadow, var(--shadow-md));
  }

  .card2--outlined {
    background-color: var(--card2-outlined-bg, var(--color-bg-primary));
    border: var(--card2-border-width, 1px) solid
            var(--card2-border-color, var(--color-border-default));
  }

  .card2--filled {
    background-color: var(--card2-filled-bg, var(--color-bg-secondary));
  }

  /* ============================================
     Interactive State
     ============================================ */

  .card2--interactive {
    cursor: pointer;
    transition:
      transform var(--transition-fast),
      box-shadow var(--transition-fast),
      border-color var(--transition-fast);
    text-decoration: none;
    color: inherit;
  }

  .card2--interactive:hover {
    transform: var(--card2-hover-transform, translateY(-4px));
  }

  .card2--elevated.card2--interactive:hover {
    box-shadow: var(--card2-hover-shadow, var(--shadow-lg));
  }

  .card2--outlined.card2--interactive:hover {
    border-color: var(--card2-hover-border-color, var(--color-border-strong));
  }

  .card2--interactive:focus-visible {
    outline: 2px solid var(--color-border-focus);
    outline-offset: 2px;
  }

  /* ============================================
     Image
     ============================================ */

  .card2_image-wrapper {
    aspect-ratio: var(--card2-image-aspect, 16/9);
    overflow: hidden;
  }

  .card2_image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-normal);
  }

  .card2--interactive:hover .card2_image {
    transform: scale(1.05);
  }

  /* ============================================
     Content
     ============================================ */

  .card2_content {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
    padding: var(--card2-padding, var(--space-6));
    flex: 1;
  }

  .card2_title {
    font-family: var(--card2-title-font, var(--font-family-sans));
    font-size: var(--card2-title-size, var(--text-size-h5));
    font-weight: var(--card2-title-weight, var(--font-weight-semibold));
    line-height: var(--line-height-tight);
    margin: 0;
    color: var(--card2-title-color, var(--color-text-primary));
  }

  .card2_description {
    font-size: var(--card2-description-size, var(--text-size-small));
    line-height: var(--line-height-relaxed);
    color: var(--card2-description-color, var(--color-text-secondary));
    margin: 0;
  }

  .card2_body {
    margin-top: var(--space-2);
  }

  .card2_actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-3);
    margin-top: auto;
    padding-top: var(--space-4);
  }
</style>
